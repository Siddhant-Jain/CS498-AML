---
title: "AML hw4"
author: "Roshan Rajan, Kirsten Wong, Kenneth Zhang"
date: "February 25, 2017"
output: html_document
---

##Problem 1 7.9
```{r, echo=TRUE}
#a
brunhild = read.csv("brunhild.txt", header=TRUE)
loglogfit = lm(log(brunhild$Sulfate) ~ log(brunhild$Hours))
plot(log(brunhild$Hours), log(brunhild$Sulfate))
abline(loglogfit$coefficients)

#b
fit = lm(brunhild$Sulfate ~ brunhild$Hours)
plot(brunhild$Hours, brunhild$Sulfate)
abline(fit$coefficients)

#c
plot(loglogfit, which=c(1,1))
plot(fit, which=c(1,1))

#d
print(summary(loglogfit)$r.squared)
print(summary(fit)$r.squared)

```
d.
Taking the log of both the Hours and Sulfates variables is a much better fit than the original coordinates. In the first plot, the points don't fall too far from the fit line, and the r-squared value is much higher with the log fit than the original fit.

##Problem 2 7.10
```{r, echo=TRUE}
#a
physical = read.csv("physical.txt", header=TRUE)
fit2 = lm(Mass ~ Fore+Bicep+Chest+Neck+Shoulder+Waist+Height+Calf+Thigh+Head, data=physical)

plot(fit2, which=c(1,1))

#b
cubedfit = lm(Mass^(1/3) ~ Fore+Bicep+Chest+Neck+Shoulder+Waist+Height+Calf+Thigh+Head, data=physical)
plot(cubedfit, which=c(1,1))

#c
print(summary(fit2)$r.squared)
print(summary(cubedfit)$r.squared)
```
c. Both of the residual vs fitted plots look random. The r-squared values are both very close to 1 and are not very different, so it is hard to say whether one fit is better than the other. 

##Problem 3 7.11
```{r, echo=TRUE}
#a
abalone = read.csv("abalone.txt", header=TRUE)
fit3 = lm(Age ~ Length+Diameter+Height+Whole+Shucked+Viscera+Shell, data=abalone)
plot(fit3, which=c(1,1))

#b
fit4 = lm(Age ~ Sex+Length+Diameter+Height+Whole+Shucked+Viscera+Shell, data=abalone)
plot(fit4, which=c(1,1))

#c
fit5 = lm(log(Age) ~ Length+Diameter+Height+Whole+Shucked+Viscera+Shell, data=abalone)
plot(fit5, which=c(1,1))

#d
fit6 = lm(log(Age) ~ Sex+Length+Diameter+Height+Whole+Shucked+Viscera+Shell, data=abalone)
plot(fit6, which=c(1,1))

#e
print(summary(fit3)$r.squared) #ignores gender
print(summary(fit4)$r.squared) #includes gender
print(summary(fit5)$r.squared) #ignores gender, uses log of age
print(summary(fit6)$r.squared) #includes gender, uses log of age
```
e. Comparing fit3 with fit4, and fit5 with fit 6, they are not very different. This shows us that gender does not play a very big part in determining age. fit5 and fit6, which take the log of the age, have slightly better r-squared values than fit3 and fit4, so we would use the regression with the log of ages for prediction. 

```{r, echo=TRUE}
#f
library(glmnet)
xfactors = model.matrix(abalone$Age ~ abalone$Sex)
x = as.matrix(data.frame(abalone$Sex, abalone$Length, abalone$Diameter, abalone$Height, abalone$Whole, abalone$Shucked, abalone$Viscera, abalone$Shell, xfactors))

cvfit = cv.glmnet(x, y=abalone$Age)
plot(cvfit)
```